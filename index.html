<!DOCTYPE html>
<html lang="te">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVK ENTERPRISE Order Form</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f0f2f5; padding: 15px; }
        .card { background: white; padding: 20px; border-radius: 12px; max-width: 600px; margin: auto; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 2px solid #FFC107; padding-bottom: 10px; }
        .logo { width: 80px; height: 80px; border-radius: 50%; }
        
        /* Table Style for Stock */
        .stock-container { margin-top: 20px; overflow-x: auto; max-height: 300px; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { background: #075E54; color: white; padding: 10px; position: sticky; top: 0; }
        td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
        
        .search-box { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #075E54; border-radius: 8px; box-sizing: border-box; }
        .order-btn { background-color: #25D366; color: white; padding: 15px; border: none; width: 100%; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <div class="header">
        <img src="https://raw.githubusercontent.com/cvkenterprise-hub/cvkenterprise/main/logo.png" class="logo">
        <h2>CVK ENTERPRISE</h2>
        <p style="font-size: 12px;">‡∞ó‡∞§ 2.5 ‡∞∏‡∞Ç‡∞µ‡∞§‡±ç‡∞∏‡∞∞‡∞æ‡∞≤‡±Å‡∞ó‡∞æ ‡∞µ‡∞ø‡∞∂‡∞æ‡∞ñ‡∞™‡∞ü‡±ç‡∞®‡∞Ç‡∞≤‡±ã ‡∞Ö‡∞§‡±ç‡∞Ø‡±Å‡∞§‡±ç‡∞§‡∞Æ ‡∞∏‡±á‡∞µ‡∞≤‡±Å</p>
    </div>

    <h3>üì¶ Live Stock (A to E Columns)</h3>
    <input type="text" id="search" class="search-box" placeholder="‡∞µ‡±Ü‡∞§‡∞ï‡∞Ç‡∞°‡∞ø (Product, MRP, Details)..." onkeyup="filterData()">
    
    <div id="loading" style="text-align:center;">‡∞°‡±á‡∞ü‡∞æ ‡∞≤‡±ã‡∞°‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±ã‡∞Ç‡∞¶‡∞ø...</div>
    
    <div class="stock-container">
        <table id="stockTable" style="display:none;">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>MRP</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody id="stockBody"></tbody>
        </table>
    </div>

    <hr>
    
    <h3>üõí ‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞´‡∞æ‡∞Æ‡±ç</h3>
    <input type="text" id="custName" placeholder="‡∞Æ‡±Ä ‡∞™‡±á‡∞∞‡±Å" style="width:100%; padding:10px; margin-bottom:10px;">
    <input list="productList" id="selectedProd" placeholder="‡∞™‡±ç‡∞∞‡±ã‡∞°‡∞ï‡±ç‡∞ü‡±ç ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø" style="width:100%; padding:10px; margin-bottom:10px;">
    <datalist id="productList"></datalist>
    <input type="number" id="qty" value="1" style="width:100%; padding:10px; margin-bottom:10px;">

    <button class="order-btn" onclick="sendToWhatsApp()">WhatsApp ‡∞≤‡±ã ‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞™‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø</button>
</div>

<script>
    // ‡∞Æ‡±Ä ‡∞ï‡±ä‡∞§‡±ç‡∞§ Web App URL ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞™‡±Ü‡∞ü‡±ç‡∞ü‡∞Ç‡∞°‡∞ø
    const scriptUrl = 'https://script.google.com/macros/s/AKfycbyAvqWNIyBJDKK6E1K51QlOKddsVyaznfJp7MbE7loD2w5XnaNOtJSY6vAmneMRwjEW/exec';

    async function loadStock() {
        try {
            const res = await fetch(scriptUrl);
            const data = await res.json();
            let tableHtml = "";
            let optionsHtml = "";

            data.forEach(item => {
                tableHtml += `<tr>
                    <td><b>${item.ProductName}</b><br><small>${item.Description || ''}</small></td>
                    <td>${item.Mrp || '-'}</td>
                    <td>${item.Details || '-'}</td>
                </tr>`;
                optionsHtml += `<option value="${item.ProductName}">`;
            });

            document.getElementById('stockBody').innerHTML = tableHtml;
            document.getElementById('productList').innerHTML = optionsHtml;
            document.getElementById('loading').style.display = 'none';
            document.getElementById('stockTable').style.display = 'table';
        } catch (error) {
            document.getElementById('loading').innerHTML = "‡∞°‡±á‡∞ü‡∞æ ‡∞≤‡±ã‡∞°‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞Ç‡∞≤‡±ã ‡∞≤‡±ã‡∞™‡∞Ç ‡∞ú‡∞∞‡∞ø‡∞ó‡∞ø‡∞Ç‡∞¶‡∞ø";
        }
    }

    function filterData() {
        let input = document.getElementById('search').value.toUpperCase();
        let tr = document.getElementById('stockTable').getElementsByTagName('tr');
        for (let i = 1; i < tr.length; i++) {
            tr[i].style.display = tr[i].innerText.toUpperCase().includes(input) ? "" : "none";
        }
    }

    function sendToWhatsApp() {
        const name = document.getElementById('custName').value;
        const prod = document.getElementById('selectedProd').value;
        const qty = document.getElementById('qty').value;
        if(!name || !prod) { alert("‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å ‡∞®‡∞ø‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø"); return; }
        
        const msg = `*New Order - CVK Enterprise*\nName: ${name}\nProduct: ${prod}\nQty: ${qty}`;
        // Net::ERR_UNKNOWN_URL_SCHEME ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ö‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø https://wa.me/ ‡∞µ‡∞æ‡∞°‡±Å‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å
        window.location.href = `https://wa.me/919642162599?text=${encodeURIComponent(msg)}`;
    }

    window.onload = loadStock;
</script>

</body>
</html>
